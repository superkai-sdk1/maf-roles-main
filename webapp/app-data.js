// =====================================================
// –û—Å–Ω–æ–≤–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Vue –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
// –ß–∞—Å—Ç—å 2 –∏–∑ 5: app-data.js
// =====================================================

console.log('üì¶ –ó–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è app-data.js...');

// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Vue –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
Vue.mixin(window.votingMixin);
Vue.mixin(window.timerMixin || {});

window.app = new Vue({
    el: '#app',
    data: {
        tournament: undefined,
        gameSelected: undefined,
        tableSelected: undefined,
        playersData: new Map(),
        roles: {},        playersAvatarEx: new Map(),
        playersActions: {},
        sendAuto: true,
        playersDataOnline: new Map(),
        avatarsFromServer: {}, // –î–æ–±–∞–≤–ª—è–µ–º –ø–æ–ª–µ –¥–ª—è –∞–≤–∞—Ç–∞—Ä–æ–≤ —Å —Å–µ—Ä–≤–µ—Ä–∞
        showModal: true,        tournamentId: '',
        inputMode: 'gomafia',
        manualMode: false,
        manualPlayersCount: 10,
        manualPlayers: [], // –î–æ–±–∞–≤–ª—è–µ–º –º–∞—Å—Å–∏–≤ –∏–≥—Ä–æ–∫–æ–≤ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
        manualGames: [],
        manualGameSelected: 1,        editRoles: true,
        isObs: false, // –î–æ–±–∞–≤–ª—è–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é isObs
        mainInfoText: "",
        additionalInfoText: "",
        mainInfoVisible: true,
        additionalInfoVisible: true,
        hideSeating: false,
        hideLeaveOrder: false,
        hideRolesStatus: false,
        hideBestMove: false,
        highlightedPlayer: null,
        showBestMoveModal: false,
        firstKilledPlayer: null,
        bestMove: [],
        bestMoveSelected: false,
        showRoomModal: true,
        roomInput: '',
        ws: null,
        roomId: null,
        showRoomNumber: false,
        stateReceived: false,
        waitingForState: false,
        avatarsFromServer: null,        avatarsJustLoaded: false,
        isMasterPanel: false,
        panelId: null,
        activePanelId: null,
        isActivePanel: true,
        showSettingsModal: false,
        showThemeModal: false,
        userEditedAdditionalInfo: false,
        sendFullStateTimer: null, // –¢–∞–π–º–µ—Ä –¥–ª—è –¥–µ–±–∞—É–Ω—Å–∏–Ω–≥–∞ sendFullState
        activeVotingTab: 0, // –ò–Ω–¥–µ–∫—Å –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏ –≤ –∏—Å—Ç–æ—Ä–∏–∏ –≥–æ–ª–æ—Å–æ–≤–∞–Ω–∏–π
        
        // –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∏–≥—Ä–æ–∫–∞ (–æ—Ç–∫–ª—é—á–µ–Ω–æ)
        showReturnPlayerModal: false,
        returnPlayerNumber: null,
        returnPlayerRoleKey: null,
        
        // –¶–≤–µ—Ç–æ–≤—ã–µ —Å—Ö–µ–º—ã
        colorSchemes: [
            { key: 'purple', name: 'TITAN (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)', accent: '#ae8cff', glow: '#ae8cff', preview: 'linear-gradient(135deg,#ae8cff 60%,#5b3e9c 100%)', icon: 'üíú' },
            { key: 'blue', name: '–ì–æ–ª—É–±–æ–π –ª–µ–¥', accent: '#4fc3f7', glow: '#4fc3f7', preview: 'linear-gradient(135deg,#4fc3f7 60%,#1976d2 100%)', icon: 'üíß' },
            { key: 'green', name: '–ò–∑—É–º—Ä—É–¥', accent: '#6fe7b7', glow: '#6fe7b7', preview: 'linear-gradient(135deg,#6fe7b7 60%,#11998e 100%)', icon: 'üåø' },
            { key: 'red', name: '–í–∏—à–Ω—è', accent: '#e63946', glow: '#e63946', preview: 'linear-gradient(135deg,#e63946 60%,#b12329 100%)', icon: 'üçí' },
            { key: 'orange', name: '–ú–∞–Ω–¥–∞—Ä–∏–Ω', accent: '#ffb347', glow: '#ffb347', preview: 'linear-gradient(135deg,#ffb347 60%,#ff7f50 100%)', icon: 'üçä' },
            { key: 'pink', name: '–†–æ–∑–æ–≤—ã–π –∫–≤–∞—Ä—Ü', accent: '#ff6fcb', glow: '#ff6fcb', preview: 'linear-gradient(135deg,#ff6fcb 60%,#b24592 100%)', icon: 'üå∏' },
            { key: 'yellow', name: '–õ–∏–º–æ–Ω', accent: '#ffe066', glow: '#ffe066', preview: 'linear-gradient(135deg,#ffe066 60%,#f9d423 100%)', icon: 'üçã' },
            { key: 'teal', name: '–ë–∏—Ä—é–∑–∞', accent: '#1de9b6', glow: '#1de9b6', preview: 'linear-gradient(135deg,#1de9b6 60%,#1a2980 100%)', icon: 'ü¶ö' },
            { key: 'gold', name: '–ó–æ–ª–æ—Ç–æ', accent: '#ffd700', glow: '#ffd700', preview: 'linear-gradient(135deg,#ffd700 60%,#b8860b 100%)', icon: 'üèÜ' },
            { key: 'silver', name: '–°–µ—Ä–µ–±—Ä–æ', accent: '#b0c4de', glow: '#b0c4de', preview: 'linear-gradient(135deg,#b0c4de 60%,#8e9eab 100%)', icon: 'ü•à' },
            { key: 'aqua', name: '–ê–∫–≤–∞–º–∞—Ä–∏–Ω', accent: '#00eaff', glow: '#00eaff', preview: 'linear-gradient(135deg,#00eaff 60%,#005bea 100%)', icon: 'üåä' },
            { key: 'lime', name: '–õ–∞–π–º', accent: '#cddc39', glow: '#cddc39', preview: 'linear-gradient(135deg,#cddc39 60%,#8bc34a 100%)', icon: 'ü•ù' },
            { key: 'violet', name: '–§–∏–∞–ª–∫–∞', accent: '#9f5afd', glow: '#9f5afd', preview: 'linear-gradient(135deg,#9f5afd 60%,#6a3093 100%)', icon: 'üîÆ' },
            { key: 'brown', name: '–ö–æ—Ñ–µ', accent: '#a0522d', glow: '#a0522d', preview: 'linear-gradient(135deg,#a0522d 60%,#6f4e37 100%)', icon: '‚òï' },
            { key: 'black', name: '–¢—ë–º–Ω–∞—è –Ω–æ—á—å', accent: '#222', glow: '#333', preview: 'linear-gradient(135deg,#222 60%,#444 100%)', icon: 'üåë' },
            { key: 'mint', name: '–ú—è—Ç–∞', accent: '#98ff98', glow: '#98ff98', preview: 'linear-gradient(135deg,#98ff98 60%,#38ef7d 100%)', icon: 'üå±' },
            { key: 'peach', name: '–ü–µ—Ä—Å–∏–∫', accent: '#ffb07c', glow: '#ffb07c', preview: 'linear-gradient(135deg,#ffb07c 60%,#ff6e7f 100%)', icon: 'üçë' },
            { key: 'sky', name: '–ù–µ–±–æ', accent: '#87ceeb', glow: '#87ceeb', preview: 'linear-gradient(135deg,#87ceeb 60%,#4682b4 100%)', icon: '‚òÅÔ∏è' },
            { key: 'rose', name: '–†–æ–∑–∞', accent: '#ff007f', glow: '#ff007f', preview: 'linear-gradient(135deg,#ff007f 60%,#ffafcc 100%)', icon: 'üåπ' },
            { key: 'olive', name: '–û–ª–∏–≤–∞', accent: '#808000', glow: '#808000', preview: 'linear-gradient(135deg,#808000 60%,#bfc000 100%)', icon: 'ü´í' },
            { key: 'navy', name: '–ú–æ—Ä—Å–∫–æ–π', accent: '#001f54', glow: '#001f54', preview: 'linear-gradient(135deg,#001f54 60%,#034078 100%)', icon: '‚öì' },
            { key: 'coral', name: '–ö–æ—Ä–∞–ª–ª', accent: '#ff7f50', glow: '#ff7f50', preview: 'linear-gradient(135deg,#ff7f50 60%,#ffb347 100%)', icon: 'ü™∏' },
            { key: 'sand', name: '–ü–µ—Å–æ–∫', accent: '#ffe4b5', glow: '#ffe4b5', preview: 'linear-gradient(135deg,#ffe4b5 60%,#ffd700 100%)', icon: 'üèñÔ∏è' },
            { key: 'plum', name: '–°–ª–∏–≤–∞', accent: '#8e4585', glow: '#8e4585', preview: 'linear-gradient(135deg,#8e4585 60%,#d291bc 100%)', icon: 'üçá' },
            { key: 'ice', name: '–õ—ë–¥', accent: '#b2f7ef', glow: '#b2f7ef', preview: 'linear-gradient(135deg,#b2f7ef 60%,#40c9ff 100%)', icon: 'üßä' },
            { key: 'fire', name: '–û–≥–æ–Ω—å', accent: '#ff512f', glow: '#ff512f', preview: 'linear-gradient(135deg,#ff512f 60%,#dd2476 100%)', icon: 'üî•' },
            { key: 'forest', name: '–õ–µ—Å', accent: '#228b22', glow: '#228b22', preview: 'linear-gradient(135deg,#228b22 60%,#a8e063 100%)', icon: 'üå≤' },
            { key: 'steel', name: '–°—Ç–∞–ª—å', accent: '#4682b4', glow: '#4682b4', preview: 'linear-gradient(135deg,#4682b4 60%,#b0c4de 100%)', icon: 'üî©' },
            { key: 'ruby', name: '–†—É–±–∏–Ω', accent: '#e0115f', glow: '#e0115f', preview: 'linear-gradient(135deg,#e0115f 60%,#ff6fcb 100%)', icon: 'üíé' },
            { key: 'amber', name: '–Ø–Ω—Ç–∞—Ä—å', accent: '#ffbf00', glow: '#ffbf00', preview: 'linear-gradient(135deg,#ffbf00 60%,#ff8008 100%)', icon: 'üü°' },
        ],
        selectedColorScheme: 'purple',
        
        // –¢–µ–º—ã —Ñ–æ–Ω–∞
        backgroundThemes: [
            { key: 'ultradark', name: '–û—á–µ–Ω—å —Ç—ë–º–Ω–∞—è', bgMain: '#101014', bgSecondary: '#18181d', bgAccent: '#23232a', icon: 'üåë' },
            { key: 'dark', name: '–¢—ë–º–Ω–∞—è', bgMain: '#18181d', bgSecondary: '#23232a', bgAccent: '#2c2c36', icon: 'üåò' },
            { key: 'default', name: '–°—Ç–∞–Ω–¥–∞—Ä—Ç', bgMain: '#23232a', bgSecondary: '#2c2c36', bgAccent: '#37374a', icon: 'üåó' },
            { key: 'light', name: '–°–≤–µ—Ç–ª–∞—è', bgMain: '#f5f6fa', bgSecondary: '#e9eaf3', bgAccent: '#d8d9e6', icon: 'üå§Ô∏è' },
            { key: 'ultralight', name: '–û—á–µ–Ω—å —Å–≤–µ—Ç–ª–∞—è', bgMain: '#ffffff', bgSecondary: '#f5f6fa', bgAccent: '#e9eaf3', icon: 'üåï' },
        ],
        selectedBackgroundTheme: 'default',
        
        winnerTeam: null,
        editVotingHistory: false,
        currentMode: 'roles',
        fouls: {}, // {roleKey: 0-4}
        
        // Telegram Web App integration
        tg: null,
        isTelegramApp: false,
        telegramUser: null,
        
        techFouls: {}, // {roleKey: 0-2}
        removed: {}, // {roleKey: true/false}
        
        // –î–∞–Ω–Ω—ã–µ –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Å—Å–∏–∏
        showSessionRestoreModal: false,
        previousSession: null,        sessionRestoreChecked: false,
        isRestoringSession: false,
    },
    
    // –ë–∞–∑–æ–≤—ã–µ computed —Å–≤–æ–π—Å—Ç–≤–∞ - –±—É–¥—É—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω—ã –≤ –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª—è—Ö
    computed: {
        // –ë–∞–∑–æ–≤–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ tableOut - –±—É–¥–µ—Ç –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ –≤ app-ui-integration.js
        tableOut() {
            return this.manualPlayers || [];
        }    },
    
    // –ú–µ—Ç–æ–¥—ã - –±—É–¥—É—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω—ã –∏ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω—ã –≤ –¥—Ä—É–≥–∏—Ö –º–æ–¥—É–ª—è—Ö
    methods: {        // –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –∑–∞–≥–ª—É—à–∫–∞ –¥–ª—è joinRoom - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –æ—à–∏–±–∫—É –¥–æ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π
        joinRoom() {
            console.log('‚ö†Ô∏è joinRoom –∑–∞–≥–ª—É—à–∫–∞ –≤—ã–∑–≤–∞–Ω–∞, –ø–æ–ø—ã—Ç–∫–∞ –Ω–∞–π—Ç–∏ —Ä–µ–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥...');
            
            // –ü—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ —Ä–µ–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ –≤ window.app.methods
            if (window.app.methods && typeof window.app.methods.joinRoom === 'function' && window.app.methods.joinRoom !== this.joinRoom) {
                console.log('üîÑ –ù–∞–π–¥–µ–Ω —Ä–µ–∞–ª—å–Ω—ã–π joinRoom, –≤—ã–∑—ã–≤–∞–µ–º –µ–≥–æ...');
                return window.app.methods.joinRoom.call(this);
            }
              console.log('‚ö†Ô∏è –†–µ–∞–ª—å–Ω—ã–π joinRoom –Ω–µ –Ω–∞–π–¥–µ–Ω');
            console.log('‚ö†Ô∏è roomInput:', this.roomInput);
            // –≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∞–Ω —Ä–µ–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–µ–π –∏–∑ app-ui-integration.js
        },
        
        // –ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–∞–Ω–µ–ª–∏
        loadPanelSettings() {
            try {
                const savedSettings = localStorage.getItem('maf-panel-settings');
                if (savedSettings) {
                    const settings = JSON.parse(savedSettings);
                    
                    // –ü—Ä–∏–º–µ–Ω—è–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                    if (typeof settings.mainInfoVisible === 'boolean') {
                        this.mainInfoVisible = settings.mainInfoVisible;
                    }
                    if (typeof settings.additionalInfoVisible === 'boolean') {
                        this.additionalInfoVisible = settings.additionalInfoVisible;
                    }
                    if (typeof settings.hideSeating === 'boolean') {
                        this.hideSeating = settings.hideSeating;
                    }
                    if (typeof settings.hideLeaveOrder === 'boolean') {
                        this.hideLeaveOrder = settings.hideLeaveOrder;
                    }
                    if (typeof settings.hideRolesStatus === 'boolean') {
                        this.hideRolesStatus = settings.hideRolesStatus;
                    }
                    if (typeof settings.hideBestMove === 'boolean') {
                        this.hideBestMove = settings.hideBestMove;
                    }                    if (typeof settings.showRoomNumber === 'boolean') {
                        this.showRoomNumber = settings.showRoomNumber;
                    }
                    
                    console.log('‚úÖ –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞–Ω–µ–ª–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:', settings);
                } else {
                    console.log('‚ÑπÔ∏è –°–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞–Ω–µ–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã, –∏—Å–ø–æ–ª—å–∑—É–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é');
                }
            } catch (error) {
                console.error('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–∞–Ω–µ–ª–∏:', error);
            }
        }
    },
      // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
    mounted() {
        // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞–Ω–µ–ª–∏
        this.loadPanelSettings();
        
        // –ó–∞—â–∏—Ç–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤
        if (!this.fouls) this.fouls = {};
        if (!this.techFouls) this.techFouls = {};
        if (!this.removed) this.removed = {};
        if (!this.playersActions) this.playersActions = {};
        if (!this.roles) this.roles = {};
        
        // –ü–†–ò–ù–£–î–ò–¢–ï–õ–¨–ù–ê–Ø –ë–õ–û–ö–ò–†–û–í–ö–ê –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∏–≥—Ä–æ–∫–∞
        this.showReturnPlayerModal = false;
          // –í–ê–ñ–ù–û: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–º—ã Telegram –æ—Ç–∫–ª—é—á–µ–Ω–æ!
        // –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Ç–æ–ª—å–∫–æ —Ç–µ–º—É, –≤—ã–±—Ä–∞–Ω–Ω—É—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º –≤ –ø–∞–Ω–µ–ª–∏ —Ç–µ–º.
        // Telegram Web App –±–æ–ª—å—à–µ –Ω–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç —Ü–≤–µ—Ç–æ–≤—É—é —Å—Ö–µ–º—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram Web App —Å –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
        this.$nextTick(() => {
            if (this.initTelegramApp) {
                this.initTelegramApp();
            }
        });
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–º—ã –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –ü–ï–†–ï–î –∑–∞–≥—Ä—É–∑–∫–æ–π —Å–æ—Å—Ç–æ—è–Ω–∏—è
        this.selectedColorScheme = 'purple';
        if (this.applyColorScheme) {
            this.applyColorScheme(this.selectedColorScheme);
        }
        this.selectedBackgroundTheme = 'default';
        if (this.applyBackgroundTheme) {
            this.applyBackgroundTheme(this.selectedBackgroundTheme);
        }
          // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏
        this.$nextTick(() => {
            setTimeout(() => {
                if (this.checkAndShowSessionRestore) {
                    this.checkAndShowSessionRestore();
                }
                
                // –î–ª—è Telegram Cloud Storage –ª–æ–≥–∏–∫–∞ –ø–æ–∫–∞–∑–∞ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã—Ö –º–æ–¥–∞–ª—å–Ω—ã—Ö –æ–∫–æ–Ω 
                // –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç—Å—è –≤ processSessionData() –ø–æ—Å–ª–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–≥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
                if (!window.sessionManager || !window.sessionManager.hasTelegramCloudStorage || !window.sessionManager.hasTelegramCloudStorage()) {
                    // –ï—Å–ª–∏ –Ω–µ Telegram, —Ç–æ —Å—Ä–∞–∑—É –ø–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞ –µ—Å–ª–∏ –Ω–µ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–µ—Å—Å–∏—é
                    setTimeout(() => {
                        if (!this.showSessionRestoreModal) {
                            this.showRoomModal = true;
                            this.showModal = false;
                        }
                    }, 100);
                }
            }, 500); // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
        });
        
        this.roomId = null;
        if (!localStorage.getItem('maf-master-panel')) {
            localStorage.setItem('maf-master-panel', '1');
            this.isMasterPanel = true;
        }
        
        window.addEventListener('beforeunload', () => {
            if (this.isMasterPanel) {
                localStorage.removeItem('maf-master-panel');
            }
            // –£–≤–µ–¥–æ–º–ª—è–µ–º Telegram –æ –∑–∞–∫—Ä—ã—Ç–∏–∏
            if (this.isTelegramApp && this.tg) {
                this.tg.close();
            }        });
        
        if (this.applyBackgroundTheme) {
            this.applyBackgroundTheme(this.selectedBackgroundTheme);
        }
        
        window.addEventListener("message", (event) => {
            console.log("panel.html –ø–æ–ª—É—á–∏–ª message:", event.data);
            if (event.data && event.data.source === "obs-mafia-bridge") {
                console.log("–ü–æ–ª—É—á–µ–Ω–∞ –∫–æ–º–∞–Ω–¥–∞ –æ—Ç —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è:", event.data);
            }
        });        // –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π –≤—ã–∑–æ–≤ loadRoomState
        if (this.loadRoomState) {
            this.loadRoomState();
        }
        
        // –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –ø–∞–Ω–µ–ª–∏
        this.loadPanelSettings();
        
        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–∞–π–º–µ—Ä–æ–≤ –¥–ª—è –≤—Å–µ—Ö –∏–≥—Ä–æ–∫–æ–≤ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        this.$nextTick(() => {
            if (this.initializeAllTimers) {
                this.initializeAllTimers();
            }
        });
        
        // –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –ó–ê–©–ò–¢–ê: —É–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∏–≥—Ä–æ–∫–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ
        this.$nextTick(() => {
            this.showReturnPlayerModal = false;
            console.log('üö´ –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –≤–æ–∑–≤—Ä–∞—Ç–∞ –∏–≥—Ä–æ–∫–∞ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ');
            
            // –£–õ–¨–¢–ò–ú–ê–¢–ò–í–ù–ê–Ø –ó–ê–©–ò–¢–ê: –¥–µ–ª–∞–µ–º –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –Ω–µ–∏–∑–º–µ–Ω—è–µ–º–æ–π
            const originalValue = this.showReturnPlayerModal;
            Object.defineProperty(this, 'showReturnPlayerModal', {
                get() { return false; },
                set(value) { 
                    if (value === true) {
                        console.log('üö´ –ë–õ–û–ö–ò–†–û–í–ê–ù–û: –ü–æ–ø—ã—Ç–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å showReturnPlayerModal = true');
                    }
                    return false; 
                },                configurable: false            });
        });
    }
});

console.log('‚úÖ app-data.js –∑–∞–≥—Ä—É–∂–µ–Ω, Vue –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ –≤ window.app');

// **–ö–õ–Æ–ß–ï–í–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï:**
// –≠—Ç–∞ —Å—Ç—Ä–æ–∫–∞ –≤—ã–∑—ã–≤–∞–ª–∞ –æ—à–∏–±–∫—É, —Ç–∞–∫ –∫–∞–∫ –≤—ã–ø–æ–ª–Ω—è–ª–∞—Å—å –¥–æ —Ç–æ–≥–æ, –∫–∞–∫ –¥—Ä—É–≥–∏–µ –º–æ–¥—É–ª–∏ —É—Å–ø–µ–≤–∞–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç—å—Å—è.
// –°–∏—Å—Ç–µ–º–∞ –º–æ–¥—É–ª–µ–π –≤ app-core.js –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ, –ø–æ—ç—Ç–æ–º—É —ç—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–µ –Ω—É–∂–Ω–∞.
// console.log('üîß –ó–∞–≥–ª—É—à–∫–∞ joinRoom —Å–æ–∑–¥–∞–Ω–∞:', typeof window.app.methods.joinRoom);

// –°–æ–∑–¥–∞—ë–º –Ω–∞–±–ª—é–¥–∞—Ç–µ–ª—å –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –º–µ—Ç–æ–¥–æ–≤ –ø–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª–µ–π
let methodUpdateInterval = setInterval(() => {
    if (window.app && window.app.methods && Object.keys(window.app.methods).length > 1) {
        console.log('üîÑ –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã, –æ–±–Ω–æ–≤–ª—è–µ–º Vue —ç–∫–∑–µ–º–ø–ª—è—Ä...');
        
        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –≤—Å–µ –º–µ—Ç–æ–¥—ã –≤ Vue —ç–∫–∑–µ–º–ø–ª—è—Ä–µ
        Object.keys(window.app.methods).forEach(methodName => {
            if (typeof window.app.methods[methodName] === 'function') {
                window.app[methodName] = window.app.methods[methodName].bind(window.app);
            }
        });
        
        console.log('‚úÖ –ú–µ—Ç–æ–¥—ã –æ–±–Ω–æ–≤–ª–µ–Ω—ã –≤ Vue —ç–∫–∑–µ–º–ø–ª—è—Ä–µ');
        console.log('üîß joinRoom —Ç–∏–ø –≤ —ç–∫–∑–µ–º–ø–ª—è—Ä–µ:', typeof window.app.joinRoom);
        
        clearInterval(methodUpdateInterval);
    }
}, 100); // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–µ 100–º—Å

// –û—á–∏—â–∞–µ–º –∏–Ω—Ç–µ—Ä–≤–∞–ª —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥ –≤ –ª—é–±–æ–º —Å–ª—É—á–∞–µ
setTimeout(() => {
    if (methodUpdateInterval) {
        clearInterval(methodUpdateInterval);
    }
}, 5000);
